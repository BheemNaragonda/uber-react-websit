"use strict";(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[2086],{93706:(t,e,i)=>{i.d(e,{Z:()=>r});var n=i(83303);let s={};function r(t,e,i,r){n.Z.level>0&&s[t]&&s[t].call(null,e,i,r)}},91213:(t,e,i)=>{i.d(e,{Df:()=>s,iI:()=>o,k8:()=>a,zG:()=>r});var n=i(83303);const s={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(s,"IDENTITY",{get:()=>(n.Z.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const r={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},o={common:0,meters:1,pixels:2},a={DRAW:"draw",MASK:"mask"}},53371:(t,e,i)=>{i.d(e,{Z:()=>ie});var n=i(42144),s=i(91213),r=i(56877),o=i(38977),a=i(38521);class c{constructor(t,e){(0,n.Z)(this,"opts",void 0),(0,n.Z)(this,"source",void 0),this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:i}=this.source,{size:n}=e;let s=i;if(i&&i.length!==n){s=new Float32Array(n);const t=e.elementOffset||0;for(let e=0;e<n;++e)s[e]=i[t+e]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}var l=i(50072),u=i(16709);const d=new u.Z;function h(t,e,i,n){d.set(t,e,i);const s=d.len();return{distance:n/s,normal:new u.Z(-t/s,-e/s,-i/s)}}function p(t){return t-Math.fround(t)}let f;function g(t,e){const{size:i=1,startIndex:n=0}=e,s=void 0!==e.endIndex?e.endIndex:t.length,r=(s-n)/i;f=l.Z.allocate(f,r,{type:Float32Array,size:2*i});let o=n,a=0;for(;o<s;){for(let e=0;e<i;e++){const n=t[o++];f[a+e]=n,f[a+e+i]=p(n)}a+=2*i}return f.subarray(0,r*i*2)}var v=i(83303);function m(t){return t.stride||t.size*t.bytesPerElement}function y(t,e){e.offset&&v.Z.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const i=m(t),n=(void 0!==e.vertexOffset?e.vertexOffset:t.vertexOffset||0)*i+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:n,stride:i}}var _=i(49491),b=i(97077),P=i(18474);const A=[],w=[[0,1/0]];function C(t){const{source:e,target:i,start:n=0,size:s,getData:r}=t,o=t.end||i.length,a=e.length,c=o-n;if(a>c)return void i.set(e.subarray(0,c),n);if(i.set(e,n),!r)return;let l=a;for(;l<c;){const t=r(l,e);for(let e=0;e<s;e++)i[n+l]=t[e]||0,l++}}const j={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function T(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const i=t.type||"interpolation";return{...j[i],...e,...t,type:i}}function x(t,e){const i=e.getBuffer();return i?[i,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function S(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function M(t){t.push(t.shift())}function I(t,e){const{doublePrecision:i,settings:n,value:s,size:r}=t,o=i&&s instanceof Float64Array?2:1;return(n.noAlloc?s.length:e*r)*o}function E(t){let{buffer:e,numInstances:i,attribute:n,fromLength:s,fromStartIndices:r,getData:o=(t=>t)}=t;const a=n.doublePrecision&&n.value instanceof Float64Array?2:1,c=n.size*a,l=n.byteOffset,u=n.startIndices,d=r&&u,h=I(n,i),p=n.isConstant;if(!d&&s>=h)return;const f=p?n.value:n.getBuffer().getData({srcByteOffset:l});if(n.settings.normalized&&!p){const t=o;o=(e,i)=>n.normalizeConstant(t(e,i))}const g=p?(t,e)=>o(f,e):(t,e)=>o(f.subarray(t,t+c),e),v=e.getData({length:s}),m=new Float32Array(h);!function(t){let{source:e,target:i,size:n,getData:s,sourceStartIndices:r,targetStartIndices:o}=t;if(!Array.isArray(o))return C({source:e,target:i,size:n,getData:s}),i;let a=0,c=0;const l=s&&((t,e)=>s(t+c,e)),u=Math.min(r.length,o.length);for(let t=1;t<u;t++){const s=r[t]*n,u=o[t]*n;C({source:e.subarray(a,s),target:i,start:c,end:u,size:n,getData:l}),a=s,c=u}c<i.length&&C({source:[],target:i,start:c,size:n,getData:l})}({source:v,target:m,sourceStartIndices:r,targetStartIndices:u,size:c,getData:g}),e.byteLength<m.byteLength+l&&e.reallocate(m.byteLength+l),e.subData({data:m,offset:l})}class O extends class{constructor(t,e,i){(0,n.Z)(this,"gl",void 0),(0,n.Z)(this,"id",void 0),(0,n.Z)(this,"size",void 0),(0,n.Z)(this,"settings",void 0),(0,n.Z)(this,"value",void 0),(0,n.Z)(this,"doublePrecision",void 0),(0,n.Z)(this,"_buffer",void 0),(0,n.Z)(this,"state",void 0),this.gl=t,this.id=e.id||"",this.size=e.size||1;const s=e.logicalType||e.type,a=5130===s;let c,{defaultValue:l}=e;l=Number.isFinite(l)?[l]:l||new Array(this.size).fill(0),c=a?5126:!s&&e.isIndexed?t&&(0,r.U6)(t,o.h.ELEMENT_INDEX_UINT32)?5125:5123:s||5126;let u=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(s||c||5126);this.doublePrecision=a,a&&!1===e.fp64&&(u=Float32Array),this.value=null,this.settings={...e,defaultType:u,defaultValue:l,logicalType:s,type:c,size:this.size,bytesPerElement:u.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new a.Z(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*m(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),l.Z.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const i={},n=this.value instanceof Float64Array,s=function(t,e){const i=y(t,e);return{high:i,low:{...i,offset:i.offset+4*t.size}}}(this.getAccessor(),e||{});return i[t]=new c(this,s.high),i["".concat(t,"64Low")]=n?new c(this,s.low):new Float32Array(this.size),i}if(e){const i=y(this.getAccessor(),e);return{[t]:new c(this,i)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){const e=Array.from(this.value);t=[e,e]}else{const{value:e,numInstances:i,size:n}=this,s=i*n;if(e&&s&&e.length>=s){const i=new Array(n).fill(1/0),r=new Array(n).fill(-1/0);for(let t=0;t<s;)for(let s=0;s<n;s++){const n=e[t++];n<i[s]&&(i[s]=n),n>r[s]&&(r[s]=n)}t=[i,r]}}return this.state.bounds=t,t}setData(t){const{state:e}=this;let i;i=ArrayBuffer.isView(t)?{value:t}:t instanceof a.Z?{buffer:t}:t;const n={...this.settings,...i};if(e.bufferAccessor=n,e.bounds=null,i.constant){let t=i.value;t=this._normalizeValue(t,[],0),this.settings.normalized&&(t=this.normalizeConstant(t));if(!(!e.constant||!this._areValuesEqual(t,this.value)))return!1;e.externalBuffer=null,e.constant=!0,this.value=t}else if(i.buffer){const t=i.buffer;e.externalBuffer=t,e.constant=!1,this.value=i.value||null;const s=i.value instanceof Float64Array;n.type=i.type||t.accessor.type,n.bytesPerElement=t.accessor.BYTES_PER_ELEMENT*(s?2:1),n.stride=m(n)}else if(i.value){this._checkExternalBuffer(i);let t=i.value;e.externalBuffer=null,e.constant=!1,this.value=t,n.bytesPerElement=t.BYTES_PER_ELEMENT,n.stride=m(n);const{buffer:s,byteOffset:r}=this;this.doublePrecision&&t instanceof Float64Array&&(t=g(t,n));const o=t.byteLength+r+2*n.stride;s.byteLength<o&&s.reallocate(o),s.setAccessor(null),s.subData({data:t,offset:r}),n.type=i.type||s.accessor.type}return!0}updateSubBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.bounds=null;const e=this.value,{startOffset:i=0,endOffset:n}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?g(e,{size:this.size,startIndex:i,endIndex:n}):e.subarray(i,n),offset:i*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{state:i}=this,n=i.allocatedValue,s=l.Z.allocate(n,t+1,{size:this.size,type:this.settings.defaultType,copy:e});this.value=s;const{buffer:r,byteOffset:o}=this;return r.byteLength<s.byteLength+o&&(r.reallocate(s.byteLength+o),e&&n&&r.subData({data:n instanceof Float64Array?g(n,this):n,offset:o})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!ArrayBuffer.isView(e))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const i=this.settings.defaultType;let n=!1;if(this.doublePrecision&&(n=e.BYTES_PER_ELEMENT<4),n)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof i||!this.settings.normalized||"normalized"in t||v.Z.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map((t=>(t+128)/255*2-1));case 5122:return new Float32Array(t).map((t=>(t+32768)/65535*2-1));case 5121:return new Float32Array(t).map((t=>t/255));case 5123:return new Float32Array(t).map((t=>t/65535));default:return t}}_normalizeValue(t,e,i){const{defaultValue:n,size:s}=this.settings;if(Number.isFinite(t))return e[i]=t,e;if(!t)return e[i]=n[0],e;switch(s){case 4:e[i+3]=Number.isFinite(t[3])?t[3]:n[3];case 3:e[i+2]=Number.isFinite(t[2])?t[2]:n[2];case 2:e[i+1]=Number.isFinite(t[1])?t[1]:n[1];case 1:e[i+0]=Number.isFinite(t[0])?t[0]:n[0];break;default:let r=s;for(;--r>=0;)e[i+r]=Number.isFinite(t[r])?t[r]:n[r]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:i}=this;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}}{constructor(t,e){super(t,e,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:w}),(0,n.Z)(this,"constant",!1),this.settings.update=e.update||(e.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw(){let{clearChangedFlags:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!=typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,i=this.settings.transition;return T(Array.isArray(e)?t[e.find((e=>t[e]))]:t[e],i)}setNeedsUpdate(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,e=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:i=1/0}=e;this.state.updateRanges=function(t,e){if(t===w)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const i=[],n=t.length;let s=0;for(let r=0;r<n;r++){const n=t[r];n[1]<e[0]?(i.push(n),s=r+1):n[0]>e[1]?i.push(n):e=[Math.min(n[0],e[0]),Math.max(n[1],e[1])]}return i.splice(s,0,e),i}(this.state.updateRanges,[t,i])}else this.state.updateRanges=w}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=A}setNeedsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:e,settings:i}=this;return!i.noAlloc&&(!!i.update&&(super.allocate(t,e.updateRanges!==w),!0))}updateBuffer(t){let{numInstances:e,data:i,props:n,context:s}=t;if(!this.needsUpdate())return!1;const{state:{updateRanges:r},settings:{update:o,noAlloc:a}}=this;let c=!0;if(o){for(const[t,a]of r)o.call(s,this,{data:i,startRow:t,endRow:a,props:n,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[t,i]of r){const n=Number.isFinite(t)?this.getVertexOffset(t):0,s=Number.isFinite(i)?this.getVertexOffset(i):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:n,endOffset:s})}else;this._checkAttributeArray()}else c=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),c}setConstantValue(t){if(void 0===t||"function"==typeof t)return!1;return this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{state:i,settings:n}=this;if(!t)return i.binaryValue=null,i.binaryAccessor=null,!1;if(n.noAlloc)return!1;if(i.binaryValue===t)return this.clearNeedsUpdate(),!0;i.binaryValue=t,this.setNeedsRedraw();if(n.transform||e!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const s=t;(0,_.Z)(ArrayBuffer.isView(s.value),"invalid ".concat(n.accessor));const r=Boolean(s.size)&&s.size!==this.size;return i.binaryAccessor=(0,b.jr)(s.value,{size:s.size||this.size,stride:s.stride,offset:s.offset,startIndices:e,nested:r}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?e[t]:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const i in t)Object.assign(e,super.getShaderAttributes(i,t[i]));return e}_autoUpdater(t,e){let{data:i,startRow:n,endRow:s,props:r,numInstances:o}=e;if(t.constant)return;const{settings:a,state:c,value:l,size:u,startIndices:d}=t,{accessor:h,transform:p}=a,f=c.binaryAccessor||("function"==typeof h?h:r[h]);(0,_.Z)("function"==typeof f,'accessor "'.concat(h,'" is not a function'));let g=t.getVertexOffset(n);const{iterable:v,objectInfo:m}=(0,b.jB)(i,n,s);for(const e of v){m.index++;let i=f(e,m);if(p&&(i=p.call(this,i)),d){const e=(m.index<d.length-1?d[m.index+1]:o)-d[m.index];if(i&&Array.isArray(i[0])){let e=g;for(const n of i)t._normalizeValue(n,l,e),e+=u}else i&&i.length>u?l.set(i,g):(t._normalizeValue(i,m.target,0),(0,P.k)({target:l,source:m.target,start:g,count:e}));g+=e*u}else t._normalizeValue(i,l,g),g+=u}}_validateAttributeUpdaters(){const{settings:t}=this;if(!(t.noAlloc||"function"==typeof t.update))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let i=!0;switch(e){case 4:i=i&&Number.isFinite(t[3]);case 3:i=i&&Number.isFinite(t[2]);case 2:i=i&&Number.isFinite(t[1]);case 1:i=i&&Number.isFinite(t[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}var Z=i(93706),R=i(31559);class z{constructor(t){(0,n.Z)(this,"_inProgress",void 0),(0,n.Z)(this,"_handle",void 0),(0,n.Z)(this,"_timeline",void 0),(0,n.Z)(this,"time",void 0),(0,n.Z)(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=t,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(t){var e,i;this.cancel(),this.settings=t,this._inProgress=!0,null===(e=(i=this.settings).onStart)||void 0===e||e.call(i,this)}end(){var t,e;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(t=(e=this.settings).onEnd)||void 0===t||t.call(e,this))}cancel(){var t,e;this._inProgress&&(null===(t=(e=this.settings).onInterrupt)||void 0===t||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var t,e;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(t=(e=this.settings).onUpdate)||void 0===t||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const L="\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n";var N=i(49959),D=i(96673),k=i(39622);const U={interpolation:class{constructor(t){let{gl:e,attribute:i,timeline:s}=t;(0,n.Z)(this,"gl",void 0),(0,n.Z)(this,"type","interpolation"),(0,n.Z)(this,"attributeInTransition",void 0),(0,n.Z)(this,"settings",void 0),(0,n.Z)(this,"attribute",void 0),(0,n.Z)(this,"transition",void 0),(0,n.Z)(this,"currentStartIndices",void 0),(0,n.Z)(this,"currentLength",void 0),(0,n.Z)(this,"transform",void 0),(0,n.Z)(this,"buffers",void 0),this.gl=e,this.transition=new z(s),this.attribute=i,this.attributeInTransition=new O(e,i.settings),this.currentStartIndices=i.startIndices,this.currentLength=0,this.transform=function(t,e){const i=S(e.size);return new R.Z(t,{vs:L,defines:{ATTRIBUTE_TYPE:i},varyings:["vCurrent"]})}(e,i);const r={byteLength:0,usage:35050};this.buffers=[new a.Z(e,r),new a.Z(e,r)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();this.settings=t;const{gl:i,buffers:n,attribute:s}=this;M(n);const r={numInstances:e,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of n)E({buffer:t,...r});this.currentStartIndices=s.startIndices,this.currentLength=I(s,e),this.attributeInTransition.setData({buffer:n[1],value:s.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:n[0],aTo:x(0,s)},feedbackBuffers:{vCurrent:n[1]}})}update(){const t=this.transition.update();if(t){const{duration:t,easing:e}=this.settings,{time:i}=this.transition;let n=i/t;e&&(n=e(n)),this.transform.run({uniforms:{time:n}})}return t}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0}},spring:class{constructor(t){let{gl:e,attribute:i,timeline:s}=t;(0,n.Z)(this,"gl",void 0),(0,n.Z)(this,"type","spring"),(0,n.Z)(this,"attributeInTransition",void 0),(0,n.Z)(this,"settings",void 0),(0,n.Z)(this,"attribute",void 0),(0,n.Z)(this,"transition",void 0),(0,n.Z)(this,"currentStartIndices",void 0),(0,n.Z)(this,"currentLength",void 0),(0,n.Z)(this,"texture",void 0),(0,n.Z)(this,"framebuffer",void 0),(0,n.Z)(this,"transform",void 0),(0,n.Z)(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new z(s),this.attribute=i,this.attributeInTransition=new O(e,{...i.settings,normalized:!1}),this.currentStartIndices=i.startIndices,this.currentLength=0,this.texture=function(t){return new D.Z(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function(t,e){return new k.Z(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function(t,e,i){const n=S(e.size);return new R.Z(t,{framebuffer:i,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:n},varyings:["vNext"]})}(e,i,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new a.Z(e,r),new a.Z(e,r),new a.Z(e,r)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:i,buffers:n,attribute:s}=this,r={numInstances:e,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of n)E({buffer:t,...r});this.settings=t,this.currentStartIndices=s.startIndices,this.currentLength=I(s,e),this.attributeInTransition.setData({buffer:n[1],value:s.value}),this.transition.start({...t,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:x(0,s)}})}update(){const{buffers:t,transform:e,framebuffer:i,transition:n}=this;if(!n.update())return!1;const s=this.settings;e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:s.stiffness,damping:s.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),M(t),this.attributeInTransition.setData({buffer:t[1],value:this.attribute.value});return(0,N.z6)(i)[0]>0||n.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class F{constructor(t,e){let{id:i,timeline:s}=e;(0,n.Z)(this,"id",void 0),(0,n.Z)(this,"isSupported",void 0),(0,n.Z)(this,"gl",void 0),(0,n.Z)(this,"timeline",void 0),(0,n.Z)(this,"transitions",void 0),(0,n.Z)(this,"needsRedraw",void 0),(0,n.Z)(this,"numInstances",void 0),this.id=i,this.gl=t,this.timeline=s,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=R.Z.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update(t){let{attributes:e,transitions:i,numInstances:n}=t;this.numInstances=n||1;for(const t in e){const n=e[t],s=n.getTransitionSetting(i);s&&this._updateAttribute(t,n,s)}for(const t in this.transitions){const n=e[t];n&&n.getTransitionSetting(i)||this._removeTransition(t)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const i=this.transitions[e];i.inProgress&&(t[e]=i.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions){this.transitions[t].update()&&(this.needsRedraw=!0)}const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,i){const n=this.transitions[t];let s=!n||n.type!==i.type;if(s){if(!this.isSupported)return void v.Z.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();n&&this._removeTransition(t);const r=U[i.type];r?this.transitions[t]=new r({attribute:e,timeline:this.timeline,gl:this.gl}):(v.Z.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(i,this.numInstances))}}const B="attributeManager.invalidate";class V{constructor(t){let{id:e="attribute-manager",stats:i,timeline:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,n.Z)(this,"id",void 0),(0,n.Z)(this,"gl",void 0),(0,n.Z)(this,"attributes",void 0),(0,n.Z)(this,"updateTriggers",void 0),(0,n.Z)(this,"needsRedraw",void 0),(0,n.Z)(this,"userData",void 0),(0,n.Z)(this,"stats",void 0),(0,n.Z)(this,"attributeTransitionManager",void 0),this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new F(t,{id:"".concat(e,"-transitions"),timeline:s}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{instanced:1})}remove(t){for(const e of t)void 0!==this.attributes[e]&&(this.attributes[e].delete(),delete this.attributes[e])}invalidate(t,e){const i=this._invalidateTrigger(t,e);(0,Z.Z)(B,this,t,i)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);(0,Z.Z)(B,this,"all")}update(t){let{data:e,numInstances:i,startIndices:n=null,transitions:s,props:r={},buffers:o={},context:a={}}=t,c=!1;(0,Z.Z)("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const t in this.attributes){const s=this.attributes[t],l=s.settings.accessor;s.startIndices=n,s.numInstances=i,r[t]&&v.Z.removed("props.".concat(t),"data.attributes.".concat(t))(),s.setExternalBuffer(o[t])||s.setBinaryValue("string"==typeof l?o[l]:void 0,e.startIndices)||"string"==typeof l&&!o[l]&&s.setConstantValue(r[l])||s.needsUpdate()&&(c=!0,this._updateAttribute({attribute:s,numInstances:i,data:e,props:r,context:a})),this.needsRedraw=this.needsRedraw||s.needsRedraw()}c&&(0,Z.Z)("attributeManager.updateEnd",this,i),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:i,transitions:s})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getChangedAttributes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearChangedFlags:!1};const{attributes:e,attributeTransitionManager:i}=this,n={...i.getAttributes()};for(const s in e){const r=e[s];r.needsRedraw(t)&&!i.hasAttribute(s)&&(n[s]=r)}return n}getShaderAttributes(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t||(t=this.getAttributes());const i={};for(const n in t)e[n]||Object.assign(i,t[n].getShaderAttributes());return i}_add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(const i in t){const n=t[i];this.attributes[i]=this._createAttribute(i,n,e)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,i){const n={...e,id:t,size:(e.isIndexed?1:e.size)||1,divisor:i.instanced?1:e.divisor||0};return new O(this.gl,n)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes){this.attributes[e].getUpdateTriggers().forEach((i=>{t[i]||(t[i]=[]),t[i].push(e)}))}this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:i,updateTriggers:n}=this,s=n[t];return s&&s.forEach((t=>{const n=i[t];n&&n.setNeedsUpdate(n.id,e)})),s}_updateAttribute(t){const{attribute:e,numInstances:i}=t;if((0,Z.Z)("attribute.updateStart",e),e.constant)return void e.setConstantValue(e.value);e.allocate(i)&&(0,Z.Z)("attribute.allocate",e,i);e.updateBuffer(t)&&(this.needsRedraw=!0,(0,Z.Z)("attribute.updateEnd",e,i))}}var G=i(71936);const Y=1e-5;function W(t,e,i,n,s){const r=e-t;return(i-e)*s+-r*n+r+e}function H(t,e){if(Array.isArray(t)){let i=0;for(let n=0;n<t.length;n++){const s=t[n]-e[n];i+=s*s}return Math.sqrt(i)}return Math.abs(t-e)}const q={interpolation:class extends z{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:i,duration:n,easing:s}}=this,r=s(t/n);this._value=(0,G.t7)(e,i,r)}},spring:class extends z{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:i,stiffness:n}=this.settings,{_prevValue:s=t,_currValue:r=t}=this;let o=function(t,e,i,n,s){if(Array.isArray(i)){const r=[];for(let o=0;o<i.length;o++)r[o]=W(t[o],e[o],i[o],n,s);return r}return W(t,e,i,n,s)}(s,r,e,i,n);const a=H(o,e),c=H(o,r);a<Y&&c<Y&&(o=e,this.end()),this._prevValue=r,this._currValue=o}}};class J{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,i,n){const{transitions:s}=this;if(s.has(t)){const i=s.get(t),{value:n=i.settings.fromValue}=i;e=n,this.remove(t)}if(!(n=T(n)))return;const r=q[n.type];if(!r)return void v.Z.error("unsupported transition type '".concat(n.type,"'"))();const o=new r(this.timeline);o.start({...n,fromValue:e,toValue:i}),s.set(t,o)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,i]of this.transitions)i.update(),t[e]=i.value,i.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}const X="Awaiting state",K=Symbol.for("component"),$=Symbol.for("asyncPropDefaults"),Q=Symbol.for("asyncPropOriginal"),tt=Symbol.for("asyncPropResolved");function et(t,e){const i=nt({newProps:t,oldProps:e,propTypes:at(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=function(t,e){if(null===e)return"oldProps is null, initial diff";let i=!1;const{dataComparator:n,_dataDiff:s}=t;n?n(t.data,e.data)||(i="Data comparator detected a change"):t.data!==e.data&&(i="A new data container was supplied");i&&s&&(i=s(t.data,e.data)||i);return i}(t,e);let s=!1;return n||(s=function(t,e){if(null===e)return{all:!0};if("all"in t.updateTriggers){if(ot(t,e,"all"))return{all:!0}}const i={};let n=!1;for(const s in t.updateTriggers)if("all"!==s){ot(t,e,s)&&(i[s]=!0,n=!0)}return!!n&&i}(t,e)),{dataChanged:n,propsChanged:i,updateTriggersChanged:s,extensionsChanged:rt(t,e),transitionsChanged:it(t,e)}}function it(t,e){if(!t.transitions)return!1;const i={},n=at(t);let s=!1;for(const r in t.transitions){const o=n[r],a=o&&o.type;("number"===a||"color"===a||"array"===a)&&st(t[r],e[r],o)&&(i[r]=!0,s=!0)}return!!s&&i}function nt(t){let{newProps:e,oldProps:i,ignoreProps:n={},propTypes:s={},triggerName:r="props"}=t;if(i===e)return!1;if("object"!=typeof e||null===e)return"".concat(r," changed shallowly");if("object"!=typeof i||null===i)return"".concat(r," changed shallowly");for(const t of Object.keys(e))if(!(t in n)){if(!(t in i))return"".concat(r,".").concat(t," added");const n=st(e[t],i[t],s[t]);if(n)return"".concat(r,".").concat(t," ").concat(n)}for(const t of Object.keys(i))if(!(t in n)){if(!(t in e))return"".concat(r,".").concat(t," dropped");if(!Object.hasOwnProperty.call(e,t)){const n=st(e[t],i[t],s[t]);if(n)return"".concat(r,".").concat(t," ").concat(n)}}return!1}function st(t,e,i){let n=i&&i.equal;return n&&!n(t,e,i)?"changed deeply":n||(n=t&&e&&t.equals,!n||n.call(t,e))?n||e===t?null:"changed shallowly":"changed deeply"}function rt(t,e){if(null===e)return!0;const i=e.extensions,{extensions:n}=t;if(n===i)return!1;if(!i||!n)return!0;if(n.length!==i.length)return!0;for(let t=0;t<n.length;t++)if(!n[t].equals(i[t]))return!0;return!1}function ot(t,e,i){let n=t.updateTriggers[i];n=null==n?{}:n;let s=e.updateTriggers[i];s=null==s?{}:s;return nt({oldProps:s,newProps:n,triggerName:i})}function at(t){const e=t[K],i=e&&e.constructor;return i?i._propTypes:{}}function ct(t){if(!function(t){return null!==t&&"object"==typeof t}(t))throw new Error("count(): argument not an object");if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"==typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}var lt=i(1604),ut=i(74310);function dt(t,e){if(!e)return t;const i={...t,...e};if("defines"in e&&(i.defines={...t.defines,...e.defines}),"modules"in e&&(i.modules=(t.modules||[]).concat(e.modules),e.modules.some((t=>"project64"===t.name)))){const t=i.modules.findIndex((t=>"project32"===t.name));t>=0&&i.modules.splice(t,1)}if("inject"in e)if(t.inject){const n={...t.inject};for(const t in e.inject)n[t]=(n[t]||"")+e.inject[t];i.inject=n}else i.inject=e.inject;return i}var ht=i(60754),pt=i(78491),ft=i(41687),gt=i(22501);const vt=Math.PI/180,mt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],yt=[0,0,0],_t={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class bt{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,n.Z)(this,"id",void 0),(0,n.Z)(this,"x",void 0),(0,n.Z)(this,"y",void 0),(0,n.Z)(this,"width",void 0),(0,n.Z)(this,"height",void 0),(0,n.Z)(this,"isGeospatial",void 0),(0,n.Z)(this,"zoom",void 0),(0,n.Z)(this,"focalDistance",void 0),(0,n.Z)(this,"position",void 0),(0,n.Z)(this,"modelMatrix",void 0),(0,n.Z)(this,"distanceScales",void 0),(0,n.Z)(this,"scale",void 0),(0,n.Z)(this,"center",void 0),(0,n.Z)(this,"cameraPosition",void 0),(0,n.Z)(this,"projectionMatrix",void 0),(0,n.Z)(this,"viewMatrix",void 0),(0,n.Z)(this,"viewMatrixUncentered",void 0),(0,n.Z)(this,"viewMatrixInverse",void 0),(0,n.Z)(this,"viewProjectionMatrix",void 0),(0,n.Z)(this,"pixelProjectionMatrix",void 0),(0,n.Z)(this,"pixelUnprojectionMatrix",void 0),(0,n.Z)(this,"resolution",void 0),(0,n.Z)(this,"_frustumPlanes",{}),this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.distanceScales=t.distanceScales||_t,this.focalDistance=t.focalDistance||1,this.position=t.position||yt,this.modelMatrix=t.modelMatrix||null;const{longitude:e,latitude:i}=t;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(e),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?s.zG.WEB_MERCATOR:s.zG.WEB_MERCATOR_AUTO_OFFSET:s.zG.IDENTITY}equals(t){return t instanceof bt&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&(0,G.fS)(t.projectionMatrix,this.projectionMatrix)&&(0,G.fS)(t.viewMatrix,this.viewMatrix))}project(t){let{topLeft:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=this.projectPosition(t),n=(0,gt.aW)(i,this.pixelProjectionMatrix),[s,r]=n,o=e?r:this.height-r;return 2===t.length?[s,o]:[s,o,n[2]]}unproject(t){let{topLeft:e=!0,targetZ:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[n,s,r]=t,o=e?s:this.height-s,a=i&&i*this.distanceScales.unitsPerMeter[2],c=(0,gt.CT)([n,o,r],this.pixelUnprojectionMatrix,a),[l,u,d]=this.unprojectPosition(c);return Number.isFinite(r)?[l,u,d]:Number.isFinite(i)?[l,u,i]:[l,u]}projectPosition(t){const[e,i]=this.projectFlat(t);return[e,i,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,i]=this.unprojectFlat(t);return[e,i,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){if(this.isGeospatial){const e=(0,gt.w5)(t);return e[1]=(0,G.uZ)(e[1],-318,830),e}return t}unprojectFlat(t){return this.isGeospatial?(0,gt.es)(t):t}getBounds(){const t={targetZ:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0},e=this.unproject([0,0],t),i=this.unproject([this.width,0],t),n=this.unproject([0,this.height],t),s=this.unproject([this.width,this.height],t);return[Math.min(e[0],i[0],n[0],s[0]),Math.min(e[1],i[1],n[1],s[1]),Math.max(e[0],i[0],n[0],s[0]),Math.max(e[1],i[1],n[1],s[1])]}getDistanceScales(t){return t?(0,gt.ro)({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel(t){let{x:e,y:i,width:n=1,height:s=1}=t;return e<this.x+this.width&&this.x<e+n&&i<this.y+this.height&&this.y<i+s}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function(t){return{left:h(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:h(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:h(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:h(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:h(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:h(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,e){return null}_initProps(t){const e=t.longitude,i=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=(0,gt.Bf)({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||(0,gt.ro)({latitude:i,longitude:e}));const n=Math.pow(2,this.zoom);this.scale=n;const{position:s,modelMatrix:r}=t;let o=yt;if(s&&(o=r?new pt.Z(r).transformAsVector(s,[]):s),this.isGeospatial){const t=this.projectPosition([e,i,0]);this.center=new u.Z(o).scale(this.distanceScales.unitsPerMeter).add(t)}else this.center=this.projectPosition(o)}_initMatrices(t){const{viewMatrix:e=mt,projectionMatrix:i=null,orthographic:n=!1,fovyRadians:s,fovy:r=75,near:o=.1,far:a=1e3,padding:c=null,focalDistance:l=1}=t;this.viewMatrixUncentered=e,this.viewMatrix=(new pt.Z).multiplyRight(e).translate(new u.Z(this.center).negate()),this.projectionMatrix=i||function(t){let{width:e,height:i,orthographic:n,fovyRadians:s,focalDistance:r,padding:o,near:a,far:c}=t;const l=e/i,u=n?(new pt.Z).orthographic({fovy:s,aspect:l,focalDistance:r,near:a,far:c}):(new pt.Z).perspective({fovy:s,aspect:l,near:a,far:c});if(o){const{left:t=0,right:n=0,top:s=0,bottom:r=0}=o,a=(0,G.uZ)((t+e-n)/2,0,e)-e/2,c=(0,G.uZ)((s+i-r)/2,0,i)-i/2;u[8]-=2*a/e,u[9]+=2*c/i}return u}({width:this.width,height:this.height,orthographic:n,fovyRadians:s||r*vt,focalDistance:l,padding:c,near:o,far:a});const d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];ft.Jp(d,d,this.projectionMatrix),ft.Jp(d,d,this.viewMatrix),this.viewProjectionMatrix=d,this.viewMatrixInverse=ft.U_([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function(t){return[t[12],t[13],t[14]]}(this.viewMatrixInverse);const h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];ft.bA(h,h,[this.width/2,-this.height/2,1]),ft.Iu(h,h,[1,-1,0]),ft.Jp(p,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=p,this.pixelUnprojectionMatrix=ft.U_([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||v.Z.warn("Pixel project matrix not invertible")()}}(0,n.Z)(bt,"displayName","Viewport");var Pt=i(82395),At=i(34077),wt=i(95320);const Ct=Math.PI/180;function jt(t){return 512/4003e4/Math.cos(t*Ct)}class Tt extends bt{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{latitude:e=0,longitude:i=0,zoom:s=0,pitch:r=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:c=1.01,orthographic:l=!1,projectionMatrix:u,repeat:d=!1,worldOffset:h=0,legacyMeterSizes:p=!1}=t;let{width:f,height:g,altitude:v=1.5}=t;const m=Math.pow(2,s);let y;f=f||1,g=g||1;let _=null;u?(v=u[5]/2,y=(0,gt.Lu)(v)):(t.fovy?(y=t.fovy,v=(0,gt.sj)(y)):y=(0,gt.Lu)(v),_=(0,gt.wl)({width:f,height:g,pitch:r,fovy:y,nearZMultiplier:a,farZMultiplier:c}));let b=(0,gt.lf)({height:g,pitch:r,bearing:o,scale:m,altitude:v});if(h){b=(new pt.Z).translate([512*h,0,0]).multiplyLeft(b)}super({...t,width:f,height:g,viewMatrix:b,longitude:i,latitude:e,zoom:s,..._,fovy:y,focalDistance:v}),(0,n.Z)(this,"longitude",void 0),(0,n.Z)(this,"latitude",void 0),(0,n.Z)(this,"pitch",void 0),(0,n.Z)(this,"bearing",void 0),(0,n.Z)(this,"altitude",void 0),(0,n.Z)(this,"fovy",void 0),(0,n.Z)(this,"orthographic",void 0),(0,n.Z)(this,"_subViewports",void 0),(0,n.Z)(this,"_pseudoMeters",void 0),this.latitude=e,this.longitude=i,this.zoom=s,this.pitch=r,this.bearing=o,this.altitude=v,this.fovy=y,this.orthographic=l,this._subViewports=d?[]:null,this._pseudoMeters=p,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),i=Math.ceil((t[2]-180)/360);for(let t=e;t<=i;t++){const e=t?new Tt({...this,worldOffset:t}):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,i]=this.projectFlat(t);return[e,i,(t[2]||0)*jt(t[1])]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,i]=this.unprojectFlat(t);return[e,i,(t[2]||0)/jt(i)]}addMetersToLngLat(t,e){return(0,gt.eG)(t,e)}panByPosition(t,e){const i=(0,gt.CT)(e,this.pixelUnprojectionMatrix),n=this.projectFlat(t),s=wt.IH([],n,wt.tk([],i)),r=wt.IH([],this.center,s),[o,a]=this.unprojectFlat(r);return{longitude:o,latitude:a}}getBounds(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=(0,Pt.Z)(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{width:i,height:n}=this,{longitude:s,latitude:r,zoom:o}=(0,At.Z)({width:i,height:n,bounds:t,...e});return new Tt({width:i,height:n,longitude:s,latitude:r,zoom:o})}}(0,n.Z)(Tt,"displayName","WebMercatorViewport");var xt=i(39790),St=i(63937);function Mt(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=e.projectPosition(t);if(i&&e instanceof Tt){const[i,s,r=0]=t,o=e.getDistanceScales([i,s]);n[2]=r*o.unitsPerMeter[2]}return n}function It(t,e){let{viewport:i,modelMatrix:n,coordinateSystem:r,coordinateOrigin:o,offsetMode:a}=e,[c,l,u=0]=t;switch(n&&([c,l,u]=xt.fF([],[c,l,u,1],n)),r){case s.Df.LNGLAT:return Mt([c,l,u],i,a);case s.Df.LNGLAT_OFFSETS:return Mt([c+o[0],l+o[1],u+(o[2]||0)],i,a);case s.Df.METER_OFFSETS:return Mt((0,gt.eG)(o,[c,l,u]),i,a);case s.Df.CARTESIAN:default:return i.isGeospatial?[c+o[0],l+o[1],u+o[2]]:i.projectPosition([c,l,u])}}function Et(t,e){const{viewport:i,coordinateSystem:n,coordinateOrigin:r,modelMatrix:o,fromCoordinateSystem:a,fromCoordinateOrigin:c}=function(t){const{viewport:e,modelMatrix:i,coordinateOrigin:n}=t;let{coordinateSystem:r,fromCoordinateSystem:o,fromCoordinateOrigin:a}=t;return r===s.Df.DEFAULT&&(r=e.isGeospatial?s.Df.LNGLAT:s.Df.CARTESIAN),void 0===o&&(o=r),void 0===a&&(a=n),{viewport:e,coordinateSystem:r,coordinateOrigin:n,modelMatrix:i,fromCoordinateSystem:o,fromCoordinateOrigin:a}}(e),{geospatialOrigin:l,shaderCoordinateOrigin:u,offsetMode:d}=(0,ht.v)(i,n,r),h=It(t,{viewport:i,modelMatrix:o,coordinateSystem:a,coordinateOrigin:c,offsetMode:d});if(d){const t=i.projectPosition(l||u);St.lu(h,h,t)}return h}const Ot={10241:9987,10240:9729,10242:33071,10243:33071},Zt={};function Rt(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const i in t){const n=t[i],s=e[i];if(!(n===s||Array.isArray(n)&&Array.isArray(s)&&Rt(n,s)))return!1}return!0}const zt={boolean:{validate:(t,e)=>!0,equal:(t,e,i)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||kt(t)&&(3===t.length||4===t.length),equal:(t,e,i)=>Lt(t,e)},accessor:{validate(t,e){const i=Ut(t);return"function"===i||i===Ut(e.value)},equal:(t,e,i)=>"function"==typeof e||Lt(t,e)},array:{validate:(t,e)=>e.optional&&!t||kt(t),equal:(t,e,i)=>i.compare?Lt(t,e):t===e},object:{equal:(t,e,i)=>i.compare?Rt(t,e):t===e},function:{validate:(t,e)=>e.optional&&!t||"function"==typeof t,equal:(t,e,i)=>!i.compare||t===e},data:{transform:(t,e,i)=>{const{dataTransform:n}=i.props;return n&&t?n(t):t}},image:{transform:(t,e,i)=>function(t,e){const i=t.context&&t.context.gl;if(!i||!e)return null;if(e instanceof D.Z)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let n=null;e.compressed&&(n={10241:e.data.length>1?9985:9729});const s=new D.Z(i,{...e,parameters:{...Ot,...n,...t.props.textureParameters}});return Zt[s.id]=!0,s}(i,t),release:t=>{!function(t){t&&t instanceof D.Z&&Zt[t.id]&&(t.delete(),delete Zt[t.id])}(t)}}};function Lt(t,e){if(t===e)return!0;if(!kt(t)||!kt(e))return!1;const i=t.length;if(i!==e.length)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Nt(t,e){switch(Ut(e)){case"object":return Dt(t,e);case"array":return Dt(t,{type:"array",value:e,compare:!1});case"boolean":return Dt(t,{type:"boolean",value:e});case"number":return Dt(t,{type:"number",value:e});case"function":return Dt(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Dt(t,e){return"type"in e?{name:t,...zt[e.type],...e}:"value"in e?{name:t,type:Ut(e.value),...e}:{name:t,type:"object",value:e}}function kt(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Ut(t){return kt(t)?"array":null===t?"null":typeof t}function Ft(t){const e=Gt(t,"_mergedDefaultProps");return e||(function(t){if(!t.prototype)return;const e=Object.getPrototypeOf(t),i=Ft(e),n=function(t){const e={},i={},n={};for(const[s,r]of Object.entries(t)){const t=null==r?void 0:r.deprecatedFor;if(t)n[s]=Array.isArray(t)?t:[t];else{const t=Nt(s,r);e[s]=t,i[s]=t.value}}return{propTypes:e,defaultProps:i,deprecatedProps:n}}(Gt(t,"defaultProps")||{}),s=function(t,e,i){const n=Object.create(null);Object.assign(n,e,t);const s=function(t){const e=Gt(t,"layerName")||Gt(t,"componentName");e||v.Z.once(0,"".concat(t.name,".componentName not specified"))();return e||t.name}(i);return delete t.id,Object.defineProperties(n,{id:{writable:!0,value:s}}),n}(n.defaultProps,i,t),r={...e._propTypes,...n.propTypes};!function(t,e){const i={},n={};for(const t in e){const s=e[t],{name:r,value:o}=s;s.async&&(i[r]=o,n[r]=Bt(r))}t[$]=i,t[Q]={},Object.defineProperties(t,n)}(s,r);const o={...e._deprecatedProps,...n.deprecatedProps};(function(t,e){for(const i in e)Object.defineProperty(t,i,{enumerable:!1,set(t){const n="".concat(this.id,": ").concat(i);for(const n of e[i])Vt(this,n)||(this[n]=t);v.Z.deprecated(n,e[i].join("/"))()}})})(s,o),t._mergedDefaultProps=s,t._propTypes=r,t._deprecatedProps=o}(t),t._mergedDefaultProps)}function Bt(t){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||(0,b.D0)(e)?this[Q][t]=e:this[tt][t]=e},get(){if(this[tt]){if(t in this[tt]){return this[tt][t]||this[$][t]}if(t in this[Q]){const e=this[K]&&this[K].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[$][t]}}return this[$][t]}}}function Vt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Gt(t,e){return Vt(t,e)&&t[e]}let Yt=0;class Wt{constructor(){(0,n.Z)(this,"id",void 0),(0,n.Z)(this,"props",void 0),(0,n.Z)(this,"count",void 0);for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.props=function(t,e){const i=Ft(t.constructor),n=Object.create(i);n[K]=t,n[Q]={},n[tt]={};for(let t=0;t<e.length;++t){const i=e[t];for(const t in i)n[t]=i[t]}return Object.freeze(n),n}(this,e),this.id=this.props.id,this.count=Yt++}clone(t){const{props:e}=this,i={};for(const t in e[$])t in e[tt]?i[t]=e[tt][t]:t in e[Q]&&(i[t]=e[Q][t]);return new this.constructor({...e,...i,...t})}}function Ht(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return(Ht=function(t){this.s=t,this.n=t.next}).prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var i=this.s.return;return void 0===i?Promise.resolve({value:t,done:!0}):e(i.apply(this.s,arguments))},throw:function(t){var i=this.s.return;return void 0===i?Promise.reject(t):e(i.apply(this.s,arguments))}},new Ht(t)}(0,n.Z)(Wt,"componentName","Component"),(0,n.Z)(Wt,"defaultProps",{});const qt=Object.freeze({});class Jt extends class{constructor(t){(0,n.Z)(this,"component",void 0),(0,n.Z)(this,"onAsyncPropUpdated",void 0),(0,n.Z)(this,"asyncProps",void 0),(0,n.Z)(this,"oldProps",void 0),(0,n.Z)(this,"oldAsyncProps",void 0),this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||qt}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){const e=t[tt]||{},i=t[Q]||t,n=t[$]||{};for(const t in e){const i=e[t];this._createAsyncPropData(t,n[t]),this._updateAsyncProp(t,i),e[t]=this.getAsyncProp(t)}for(const t in i){const e=i[t];this._createAsyncPropData(t,n[t]),this._updateAsyncProp(t,e)}}_fetch(t,e){return null}_onResolve(t,e){}_onError(t,e){}_updateAsyncProp(t,e){this._didAsyncInputValueChange(t,e)&&("string"==typeof e&&(e=this._fetch(t,e)),e instanceof Promise?this._watchPromise(t,e):(0,b.D0)(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,e){const i=this.asyncProps[t];return e!==i.resolvedValue&&e!==i.lastValue&&(i.lastValue=e,!0)}_setPropValue(t,e){this._freezeAsyncOldProps();const i=this.asyncProps[t];i&&(e=this._postProcessValue(i,e),i.resolvedValue=e,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(t,e,i){const n=this.asyncProps[t];n&&i>=n.resolvedLoadCount&&void 0!==e&&(this._freezeAsyncOldProps(),n.resolvedValue=e,n.resolvedLoadCount=i,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const i=this.asyncProps[t];if(i){i.pendingLoadCount++;const n=i.pendingLoadCount;e.then((e=>{e=this._postProcessValue(i,e),this._setAsyncPropValue(t,e,n),this._onResolve(t,e)})).catch((e=>{this._onError(t,e)}))}}async _resolveAsyncIterable(t,e){if("data"!==t)return void this._setPropValue(t,e);const i=this.asyncProps[t];if(!i)return;i.pendingLoadCount++;const n=i.pendingLoadCount;let s=[],r=0;var o,a=!1,c=!1;try{for(var l,u=function(t){var e,i,n,s=2;for("undefined"!=typeof Symbol&&(i=Symbol.asyncIterator,n=Symbol.iterator);s--;){if(i&&null!=(e=t[i]))return e.call(t);if(n&&null!=(e=t[n]))return new Ht(e.call(t));i="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}(e);a=!(l=await u.next()).done;a=!1){const e=l.value;{const{dataTransform:i}=this.component.props;s=i?i(e,s):s.concat(e),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:r,endRow:s.length}]}),r=s.length,this._setAsyncPropValue(t,s,n)}}}catch(t){c=!0,o=t}finally{try{a&&null!=u.return&&await u.return()}finally{if(c)throw o}}this._onResolve(t,s)}_postProcessValue(t,e){const i=t.type;return i&&(i.release&&i.release(t.resolvedValue,i,this.component),i.transform)?i.transform(e,i,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const i=this.component&&this.component.constructor._propTypes;this.asyncProps[t]={type:i&&i[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}{constructor(t){let{attributeManager:e,layer:i}=t;super(i),(0,n.Z)(this,"attributeManager",void 0),(0,n.Z)(this,"needsRedraw",void 0),(0,n.Z)(this,"needsUpdate",void 0),(0,n.Z)(this,"subLayers",void 0),(0,n.Z)(this,"usesPickingColorCache",void 0),(0,n.Z)(this,"changeFlags",void 0),(0,n.Z)(this,"viewport",void 0),(0,n.Z)(this,"uniformTransitions",void 0),(0,n.Z)(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(t){this.component=t}_fetch(t,e){const i=this.component.props.fetch;return i?i(e,{propName:t,layer:this.layer}):super._fetch(t,e)}_onResolve(t,e){const i=this.component.props.onDataLoad;"data"===t&&i&&i(e,{propName:t,layer:this.layer})}_onError(t,e){this.layer.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}}var Xt=i(64878);const Kt=2**24-1,$t=Object.freeze([]),Qt=(0,ut.Z)((t=>{let{oldViewport:e,viewport:i}=t;return e.equals(i)}));let te=new Uint8ClampedArray(0);const ee={data:{type:"data",value:$t,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,e)=>{let{propName:i,layer:n,loaders:s,loadOptions:r,signal:o}=e;const{resourceManager:a}=n.context;var c;(r=r||n.getLoadOptions(),s=s||n.props.loaders,o)&&(r={...r,fetch:{...null===(c=r)||void 0===c?void 0:c.fetch,signal:o}});let l=a.contains(t);return l||r||(a.add({resourceId:t,data:(0,Xt.z)(t,s),persistent:!1}),l=!0),l?a.subscribe({resourceId:t,onChange:t=>{var e;return null===(e=n.internalState)||void 0===e?void 0:e.reloadAsyncProp(i,t)},consumerId:n.id,requestId:i}):(0,Xt.z)(t,s,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:s.k8.DRAW,onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:s.Df.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:t=>{let{layerIndex:e}=t;return[0,100*-e]},compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class ie extends Wt{constructor(){super(...arguments),(0,n.Z)(this,"internalState",null),(0,n.Z)(this,"lifecycle",X),(0,n.Z)(this,"context",void 0),(0,n.Z)(this,"state",void 0),(0,n.Z)(this,"parent",null)}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}project(t){(0,_.Z)(this.internalState);const e=this.internalState.viewport||this.context.viewport,i=It(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[n,s,r]=(0,gt.aW)(i,e.pixelProjectionMatrix);return 2===t.length?[n,s]:[n,s,r]}unproject(t){(0,_.Z)(this.internalState);return(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,e){(0,_.Z)(this.internalState);return Et(t,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===s.Df.DEFAULT||t===s.Df.LNGLAT||t===s.Df.CARTESIAN}onHover(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}onClick(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){(0,_.Z)(t instanceof Uint8Array);const[e,i,n]=t;return e+256*i+65536*n-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:ct(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var t;const e=this.getAttributeManager();if(!e)return null;const{positions:i,instancePositions:n}=e.attributes;return null===(t=i||n)||void 0===t?void 0:t.getBounds()}getShaders(t){for(const e of this.props.extensions)t=dt(t,e.getShaders.call(this,e));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const e=this.getAttributeManager(),{dataChanged:i}=t.changeFlags;if(i&&e)if(Array.isArray(i))for(const t of i)e.invalidateAll(t);else e.invalidateAll();const{props:n,oldProps:s}=t,r=Number.isInteger(s.highlightedObjectIndex)||s.pickable,o=Number.isInteger(n.highlightedObjectIndex)||n.pickable;if(r!==o&&e){const{pickingColors:t,instancePickingColors:i}=e.attributes,n=t||i;n&&(o&&n.constant&&(n.constant=!1,e.invalidate(n.id)),n.value||o||(n.constant=!0,n.value=[0,0,0]))}}finalizeState(t){for(const t of this.getModels())t.delete();const e=this.getAttributeManager();e&&e.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo(t){let{info:e,mode:i,sourceLayer:n}=t;const{index:s}=e;return s>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[s]),e}raiseError(t,e){var i,n,s,r;(e&&(t.message="".concat(e,": ").concat(t.message)),null!==(i=(n=this.props).onError)&&void 0!==i&&i.call(n,t))||(null===(s=this.context)||void 0===s||null===(r=s.onError)||void 0===r||r.call(s,t,this))}getNeedsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(t)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var t;return(null===(t=this.internalState)||void 0===t?void 0:t.uniformTransitions.active)||!1}activateViewport(t){if(!this.internalState)return;const e=this.internalState.viewport;this.internalState.viewport=t,e&&Qt({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";const e=this.getAttributeManager();e&&("all"===t?e.invalidateAll():e.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const e=this.props,i=this.getNumInstances(),n=this.getStartIndices();t.update({data:e.data,numInstances:i,startIndices:n,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});const s=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),i=Object.create(this.props);for(const t in e)Object.defineProperty(i,t,{value:e[t]});return i}return this.props}calculateInstancePickingColors(t,e){let{numInstances:i}=e;if(t.constant)return;const n=Math.floor(te.length/3);if(this.internalState.usesPickingColorCache=!0,n<i){i>Kt&&v.Z.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),te=l.Z.allocate(te,i,{size:3,copy:!0,maxCount:Math.max(i,Kt)});const t=Math.floor(te.length/3),e=[];for(let i=n;i<t;i++)this.encodePickingColor(i,e),te[3*i+0]=e[0],te[3*i+1]=e[1],te[3*i+2]=e[2]}t.value=te.subarray(0,3*i)}_setModelAttributes(t,e){const i=this.getAttributeManager(),n=t.userData.excludeAttributes||{},s=i.getShaderAttributes(e,n);t.setAttributes(s)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:i}=this.getAttributeManager().attributes,n=e||i;if(!n)return;const s=n.getVertexOffset(t),r=n.getVertexOffset(t+1);n.buffer.subData({data:new Uint8Array(r-s),offset:s})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,i=t||e;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==te.buffer&&(i.value=te.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){(0,_.Z)(!this.internalState),(0,_.Z)(Number.isFinite(this.props.coordinateSystem)),(0,Z.Z)("layer.initialize",this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Jt({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(v.Z.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new J(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){(0,Z.Z)("layer.matched",this,this===t);const{state:e,internalState:i}=t;this!==t&&(this.internalState=i,this.internalState.layer=this,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if((0,Z.Z)("layer.update",this,t),!t)return;const e=this.props,i=this.context,n=this.internalState,s=i.viewport,r=this._updateUniformTransition();n.propsInTransition=r,i.viewport=n.viewport||s,this.props=r;try{const t=this._getUpdateParams(),r=this.getModels();if(i.gl)this.updateState(t);else try{this.updateState(t)}catch(t){}for(const e of this.props.extensions)e.updateState.call(this,t,e);const o=this.getModels()[0]!==r[0];this._postUpdate(t,o)}finally{i.viewport=s,this.props=e,this._clearChangeFlags(),n.needsUpdate=!1,n.resetOldProps()}}_finalize(){(0,Z.Z)("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}_drawLayer(t){let{moduleParameters:e=null,uniforms:i={},parameters:n={}}=t;this._updateAttributeTransition();const s=this.props,r=this.context;this.props=this.internalState.propsInTransition||s;const o=this.props.opacity;i.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:t}=this.props,o=t&&t(i)||[0,0];(0,lt.dR)(r.gl,{polygonOffset:o}),(0,lt.s8)(r.gl,n,(()=>{const t={moduleParameters:e,uniforms:i,parameters:n,context:r};for(const e of this.props.extensions)e.draw.call(this,t,e);this.draw(t)}))}finally{this.props=s}}getChangeFlags(){var t;return null===(t=this.internalState)||void 0===t?void 0:t.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:e}=this.internalState;for(const i in t)if(t[i]){let n=!1;switch(i){case"dataChanged":const s=t[i],r=e[i];s&&Array.isArray(r)&&(e.dataChanged=Array.isArray(s)?r.concat(s):s,n=!0);default:e[i]||(e[i]=t[i],n=!0)}n&&(0,Z.Z)("layer.changeFlag",this,i,t)}const i=Boolean(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=i,e.somethingChanged=i||e.viewportChanged||e.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,e){const i=et(t,e);if(i.updateTriggersChanged)for(const t in i.updateTriggersChanged)i.updateTriggersChanged[t]&&this.invalidateAttribute(t);if(i.transitionsChanged)for(const s in i.transitionsChanged){var n;this.internalState.uniformTransitions.add(s,e[s],t[s],null===(n=t.transitions)||void 0===n?void 0:n[s])}return this.setChangeFlags(i)}validateProps(){!function(t){const e=at(t);for(const i in e){const n=e[i],{validate:s}=n;if(s&&!s(t[i],n))throw new Error("Invalid prop ".concat(i,": ").concat(t[i]))}}(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:i}=this.props;t.picked&&"function"==typeof i&&(e.pickingHighlightColor=i(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new V(t.gl,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,e){const{props:i,oldProps:n}=t;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;null==s||s.setInstanceCount(this.getNumInstances());const{autoHighlight:r,highlightedObjectIndex:o,highlightColor:a}=i;if(e||n.autoHighlight!==r||n.highlightedObjectIndex!==o||n.highlightColor!==a){const t={};r||(t.pickingSelectedColor=null),Array.isArray(a)&&(t.pickingHighlightColor=a),Number.isInteger(o)&&(t.pickingSelectedColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const i=this.getAttributeManager(),n=!!i&&i.getNeedsRedraw(t);return e=e||n,e}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}(0,n.Z)(ie,"defaultProps",ee),(0,n.Z)(ie,"layerName","Layer")},34005:(t,e,i)=>{i.d(e,{Z:()=>s});const n={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1};const s={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;const e={};if(void 0!==t.pickingSelectedColor)if(t.pickingSelectedColor){const i=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=i}else e.picking_uSelectedColorValid=0;if(t.pickingHighlightColor){const i=Array.from(t.pickingHighlightColor,(t=>t/255));Number.isFinite(i[3])||(i[3]=1),e.picking_uHighlightColor=i}return void 0!==t.pickingActive&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}}}},60754:(t,e,i)=>{i.d(e,{C:()=>f,v:()=>p});var n=i(41687),s=i(39790),r=i(91213),o=i(74310);const a=[0,0,0,0],c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u=[0,0,0],d=[0,0,0],h=(0,o.Z)((function(t){let{viewport:e,devicePixelRatio:i,coordinateSystem:o,coordinateOrigin:d}=t;const{projectionCenter:h,viewProjectionMatrix:f,originCommon:g,cameraPosCommon:v,shaderCoordinateOrigin:m,geospatialOrigin:y}=function(t,e,i){const{viewMatrixUncentered:r,projectionMatrix:o}=t;let{viewMatrix:l,viewProjectionMatrix:u}=t,d=a,h=a,f=t.cameraPosition;const{geospatialOrigin:g,shaderCoordinateOrigin:v,offsetMode:m}=p(t,e,i);m&&(h=t.projectPosition(g||v),f=[f[0]-h[0],f[1]-h[1],f[2]-h[2]],h[3]=1,d=s.fF([],h,u),l=r||l,u=n.Jp([],o,l),u=n.Jp([],u,c));return{viewMatrix:l,viewProjectionMatrix:u,projectionCenter:d,originCommon:h,cameraPosCommon:f,shaderCoordinateOrigin:v,geospatialOrigin:g}}(e,o,d),_=e.getDistanceScales(),b=[e.width*i,e.height*i],P=s.fF([],[0,0,-e.focalDistance,1],e.projectionMatrix)[3]||1,A={project_uCoordinateSystem:o,project_uProjectionMode:e.projectionMode,project_uCoordinateOrigin:m,project_uCommonOrigin:g.slice(0,3),project_uCenter:h,project_uPseudoMeters:Boolean(e._pseudoMeters),project_uViewportSize:b,project_uDevicePixelRatio:i,project_uFocalDistance:P,project_uCommonUnitsPerMeter:_.unitsPerMeter,project_uCommonUnitsPerWorldUnit:_.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:u,project_uScale:e.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:f,project_uModelMatrix:l,project_uCameraPosition:v};if(y){const t=e.getDistanceScales(y);switch(o){case r.Df.METER_OFFSETS:A.project_uCommonUnitsPerWorldUnit=t.unitsPerMeter,A.project_uCommonUnitsPerWorldUnit2=t.unitsPerMeter2;break;case r.Df.LNGLAT:case r.Df.LNGLAT_OFFSETS:e._pseudoMeters||(A.project_uCommonUnitsPerMeter=t.unitsPerMeter),A.project_uCommonUnitsPerWorldUnit=t.unitsPerDegree,A.project_uCommonUnitsPerWorldUnit2=t.unitsPerDegree2;break;case r.Df.CARTESIAN:A.project_uCommonUnitsPerWorldUnit=[1,1,t.unitsPerMeter[2]],A.project_uCommonUnitsPerWorldUnit2=[0,0,t.unitsPerMeter2[2]]}}return A}));function p(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d;i.length<3&&(i=[i[0],i[1],0]);let n,s=i,o=!0;switch(n=e===r.Df.LNGLAT_OFFSETS||e===r.Df.METER_OFFSETS?i:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case r.zG.WEB_MERCATOR:e!==r.Df.LNGLAT&&e!==r.Df.CARTESIAN||(n=[0,0,0],o=!1);break;case r.zG.WEB_MERCATOR_AUTO_OFFSET:e===r.Df.LNGLAT?s=n:e===r.Df.CARTESIAN&&(s=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],n=t.unprojectPosition(s),s[0]-=i[0],s[1]-=i[1],s[2]-=i[2]);break;case r.zG.IDENTITY:s=t.position.map(Math.fround),s[2]=s[2]||0;break;case r.zG.GLOBE:o=!1,n=null;break;default:o=!1}return{geospatialOrigin:n,shaderCoordinateOrigin:s,offsetMode:o}}function f(t){let{viewport:e,devicePixelRatio:i=1,modelMatrix:n=null,coordinateSystem:s=r.Df.DEFAULT,coordinateOrigin:o=d,autoWrapLongitude:a=!1}=t;s===r.Df.DEFAULT&&(s=e.isGeospatial?r.Df.LNGLAT:r.Df.CARTESIAN);const c=h({viewport:e,devicePixelRatio:i,coordinateSystem:s,coordinateOrigin:o});return c.project_uWrapLongitude=a,c.project_uModelMatrix=n||l,c}},9381:(t,e,i)=>{i.d(e,{Z:()=>p});var n=i(61528);const s="#define SMOOTH_EDGE_RADIUS 0.5",r={name:"geometry",vs:"\n".concat(s,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(s,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")};var o=i(91213);const a=Object.keys(o.Df).map((t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(o.Df[t],";"))).join(""),c=Object.keys(o.zG).map((t=>"const int PROJECTION_MODE_".concat(t," = ").concat(o.zG[t],";"))).join(""),l=Object.keys(o.iI).map((t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(o.iI[t],";"))).join(""),u="".concat(a,"\n").concat(c,"\n").concat(l,'\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0; // meters\nconst float GLOBE_RADIUS = 256.0;\n\n// returns an adjustment factor for uCommonUnitsPerMeter\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n\n    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear\n    // Adjust by 1 / cos(latitude)\n    // If geometry.position (vertex in common space) is populated, use it\n    // Otherwise use geometry.worldPosition (anchor in world space)\n    \n    if (geometry.position.w == 0.0) {\n      float y = clamp(geometry.worldPosition.y, -89.9, 89.9);\n      return 1.0 / cos(radians(y));\n    }\n\n    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)\n    // Taylor series of 1 / cos(latitude)\n    // Max error < 0.003\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n//\n// Scaling offsets - scales meters to "world distance"\n// Note the scalar version of project_size is for scaling the z component only\n//\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\n\n// Get rotation matrix that aligns the z axis with the given up vector\n// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  // Tangent on XY plane\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n\n//\n// Projecting normal - transform deltas from current coordinate system to\n// normals in the worldspace\n//\nvec3 project_normal(vec3 vector) {\n  // Apply model matrix\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\n\n//\n// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]\n//\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\n\n//\n// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)\n//\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n\n  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        // Too far from the projection center for offset mode to be accurate\n        // Only use high parts\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n\n  // Translation is already added to the high parts\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\n\n//\n// Projects from common space coordinates to clip space.\n// Uses project_uViewProjectionMatrix\n//\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\n\n// Returns a clip space offset that corresponds to a given number of screen pixels\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  // UNIT_PIXELS\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n');var d=i(60754);const h={};const p={name:"project32",dependencies:[{name:"project",dependencies:[n.O,r],vs:u,getUniforms:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return"viewport"in t?(0,d.C)(t):{}}}],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"}},49491:(t,e,i)=>{function n(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}i.d(e,{Z:()=>n})},18474:(t,e,i)=>{function n(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;return Array.isArray(t)?s(t,e,[]):e(t)?[t]:[]}function s(t,e,i){let n=-1;for(;++n<t.length;){const r=t[n];Array.isArray(r)?s(r,e,i):e(r)&&i.push(r)}return i}function r(t){let{target:e,source:i,start:n=0,count:s=1}=t;const r=i.length,o=s*r;let a=0;for(let t=n;a<r;a++)e[t++]=i[a];for(;a<o;)a<o-a?(e.copyWithin(n+a,n,n+a),a*=2):(e.copyWithin(n+a,n,n+o-a),a=o);return e}i.d(e,{k:()=>r,x:()=>n})},97077:(t,e,i)=>{i.d(e,{D0:()=>o,jB:()=>r,jr:()=>a});const n=[],s=[];function r(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,r=n;const o={index:-1,data:t,target:[]};return t?"function"==typeof t[Symbol.iterator]?r=t:t.length>0&&(s.length=t.length,r=s):r=n,(e>0||Number.isFinite(i))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,i),o.index=e-1),{iterable:r,objectInfo:o}}function o(t){return t&&t[Symbol.asyncIterator]}function a(t,e){const{size:i,stride:n,offset:s,startIndices:r,nested:o}=e,a=t.BYTES_PER_ELEMENT,c=n?n/a:i,l=s?s/a:0,u=Math.floor((t.length-l)/c);return(e,n)=>{let{index:s,target:a}=n;if(!r){const e=s*c+l;for(let n=0;n<i;n++)a[n]=t[e+n];return a}const d=r[s],h=r[s+1]||u;let p;if(o){p=new Array(h-d);for(let e=d;e<h;e++){const n=e*c+l;a=new Array(i);for(let e=0;e<i;e++)a[e]=t[n+e];p[e-d]=a}}else if(c===i)p=t.subarray(d*i+l,h*i+l);else{p=new t.constructor((h-d)*i);let e=0;for(let n=d;n<h;n++){const s=n*c+l;for(let n=0;n<i;n++)p[e++]=t[s+n]}}return p}}},83303:(t,e,i)=>{i.d(e,{Z:()=>n});const n=new(i(44468).Z)({id:"deck"})},74310:(t,e,i)=>{function n(t,e){if(t===e)return!0;if(Array.isArray(t)){const i=t.length;if(!e||e.length!==i)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}return!1}function s(t){let e,i={};return s=>{for(const r in s)if(!n(s[r],i[r])){e=t(s),i=s;break}return e}}i.d(e,{Z:()=>s})},81382:(t,e,i)=>{i.d(e,{Z:()=>c});var n=i(42144),s=i(97077),r=i(50072),o=i(49491),a=i(38521);class c{constructor(t){(0,n.Z)(this,"opts",void 0),(0,n.Z)(this,"typedArrayManager",void 0),(0,n.Z)(this,"indexStarts",[0]),(0,n.Z)(this,"vertexStarts",[0]),(0,n.Z)(this,"vertexCount",0),(0,n.Z)(this,"instanceCount",0),(0,n.Z)(this,"attributes",void 0),(0,n.Z)(this,"_attributeDefs",void 0),(0,n.Z)(this,"data",void 0),(0,n.Z)(this,"getGeometry",void 0),(0,n.Z)(this,"geometryBuffer",void 0),(0,n.Z)(this,"buffers",void 0),(0,n.Z)(this,"positionSize",void 0),(0,n.Z)(this,"normalize",void 0);const{attributes:e={}}=t;this.typedArrayManager=r.Z,this.attributes={},this._attributeDefs=e,this.opts=t,this.updateGeometry(t)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:i={},getGeometry:n,geometryBuffer:s,positionFormat:r,dataChanged:a,normalize:c=!0}=this.opts;if(this.data=e,this.getGeometry=n,this.positionSize=s&&s.size||("XY"===r?2:3),this.buffers=i,this.normalize=c,s&&((0,o.Z)(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),c||(i.positions=s)),this.geometryBuffer=i.positions,Array.isArray(a))for(const t of a)this._rebuildGeometry(t);else this._rebuildGeometry()}updatePartialGeometry(t){let{startRow:e,endRow:i}=t;this._rebuildGeometry({startRow:e,endRow:i})}getGeometryFromBuffer(t){const e=t.value||t;return ArrayBuffer.isView(e)?(0,s.jr)(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices}):null}_allocate(t,e){const{attributes:i,buffers:n,_attributeDefs:s,typedArrayManager:r}=this;for(const o in s)if(o in n)r.release(i[o]),i[o]=null;else{const n=s[o];n.copy=e,i[o]=r.allocate(i[o],t,n)}}_forEachGeometry(t,e,i){const{data:n,getGeometry:r}=this,{iterable:o,objectInfo:a}=(0,s.jB)(n,e,i);for(const e of o){a.index++;t(r?r(e,a):null,a.index)}}_rebuildGeometry(t){if(!this.data)return;let{indexStarts:e,vertexStarts:i,instanceCount:n}=this;const{data:s,geometryBuffer:r}=this,{startRow:o=0,endRow:c=1/0}=t||{},l={};if(t||(e=[0],i=[0]),this.normalize||!r)this._forEachGeometry(((t,e)=>{const n=t&&this.normalizeGeometry(t);l[e]=n,i[e+1]=i[e]+(n?this.getGeometrySize(n):0)}),o,c),n=i[i.length-1];else if(i=s.startIndices,n=i[s.length]||0,ArrayBuffer.isView(r))n=n||r.length/this.positionSize;else if(r instanceof a.Z){const t=r.accessor.stride||4*this.positionSize;n=n||r.byteLength/t}else if(r.buffer){const t=r.stride||4*this.positionSize;n=n||r.buffer.byteLength/t}else if(r.value){const t=r.value,e=r.stride/t.BYTES_PER_ELEMENT||this.positionSize;n=n||t.length/e}this._allocate(n,Boolean(t)),this.indexStarts=e,this.vertexStarts=i,this.instanceCount=n;const u={};this._forEachGeometry(((t,s)=>{const r=l[s]||t;u.vertexStart=i[s],u.indexStart=e[s];const o=s<i.length-1?i[s+1]:n;u.geometrySize=o-i[s],u.geometryIndex=s,this.updateGeometryAttributes(r,u)}),o,c),this.vertexCount=e[e.length-1]}}},50072:(t,e,i)=>{i.d(e,{Z:()=>s});var n=i(42144);const s=new class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,n.Z)(this,"_pool",[]),(0,n.Z)(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,e,i){let{size:n=1,type:s,padding:r=0,copy:o=!1,initialize:a=!1,maxCount:c}=i;const l=s||t&&t.constructor||Float32Array,u=e*n+r;if(ArrayBuffer.isView(t)){if(u<=t.length)return t;if(u*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new l(t.buffer,0,u)}let d=1/0;c&&(d=c*n+r);const h=this._allocate(l,u,a,d);return t&&o?h.set(t):a||h.fill(0,0,4),this._release(t),h}release(t){this._release(t)}_allocate(t,e,i,n){let s=Math.max(Math.ceil(e*this.opts.overAlloc),1);s>n&&(s=n);const r=this._pool,o=t.BYTES_PER_ELEMENT*s,a=r.findIndex((t=>t.byteLength>=o));if(a>=0){const e=new t(r.splice(a,1)[0],0,s);return i&&e.fill(0),e}return new t(s)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:i}=t,{byteLength:n}=i,s=e.findIndex((t=>t.byteLength>=n));s<0?e.push(i):(s>0||e.length<this.opts.poolSize)&&e.splice(s,0,i),e.length>this.opts.poolSize&&e.shift()}}},95540:(t,e,i)=>{function n(t,e,i,n){let s,r,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(8&i)s=(n[3]-t[1])/(e[1]-t[1]),r=3;else if(4&i)s=(n[1]-t[1])/(e[1]-t[1]),r=1;else if(2&i)s=(n[2]-t[0])/(e[0]-t[0]),r=2;else{if(!(1&i))return null;s=(n[0]-t[0])/(e[0]-t[0]),r=0}for(let i=0;i<t.length;i++)o[i]=(1&r)===i?n[r]:s*(e[i]-t[i])+t[i];return o}function s(t,e){let i=0;return t[0]<e[0]?i|=1:t[0]>e[2]&&(i|=2),t[1]<e[1]?i|=4:t[1]>e[3]&&(i|=8),i}i.d(e,{W:()=>c,d:()=>o});var r=i(82276);function o(t,e){const{size:i=2,broken:o=!1,gridResolution:a=10,gridOffset:c=[0,0],startIndex:l=0,endIndex:h=t.length}=e||{},p=(h-l)/i;let f=[];const g=[f],v=(0,r.n6)(t,0,i,l);let m,y;const _=u(v,a,c,[]),b=[];(0,r.VF)(f,v);for(let e=1;e<p;e++){for(m=(0,r.n6)(t,e,i,l,m),y=s(m,_);y;){n(v,m,y,_,b);const t=s(b,_);t&&(n(v,b,t,_,b),y=t),(0,r.VF)(f,b),(0,r.JG)(v,b),d(_,a,y),o&&f.length>i&&(f=[],g.push(f),(0,r.VF)(f,v)),y=s(m,_)}(0,r.VF)(f,m),(0,r.JG)(v,m)}return o?g:g[0]}function a(t,e){for(let i=0;i<e.length;i++)t.push(e[i]);return t}function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0;if(!t.length)return[];const{size:n=2,gridResolution:r=10,gridOffset:o=[0,0],edgeTypes:c=!1}=i||{},d=[],p=[{pos:t,types:c?new Array(t.length/n).fill(1):null,holes:e||[]}],f=[[],[]];let g=[];for(;p.length;){const{pos:t,types:e,holes:i}=p.shift();h(t,n,i[0]||t.length,f),g=u(f[0],r,o,g);const v=s(f[1],g);if(v){let s=l(t,e,n,0,i[0]||t.length,g,v);const r={pos:s[0].pos,types:s[0].types,holes:[]},o={pos:s[1].pos,types:s[1].types,holes:[]};p.push(r,o);for(let u=0;u<i.length;u++)s=l(t,e,n,i[u],i[u+1]||t.length,g,v),s[0]&&(r.holes.push(r.pos.length),r.pos=a(r.pos,s[0].pos),c&&(r.types=a(r.types,s[0].types))),s[1]&&(o.holes.push(o.pos.length),o.pos=a(o.pos,s[1].pos),c&&(o.types=a(o.types,s[1].types)))}else{const n={positions:t};c&&(n.edgeTypes=e),i.length&&(n.holeIndices=i),d.push(n)}}return d}function l(t,e,i,s,o,a,c){const l=(o-s)/i,u=[],d=[],h=[],p=[],f=[];let g,v,m;const y=(0,r.n6)(t,l-1,i,s);let _=Math.sign(8&c?y[1]-a[3]:y[0]-a[2]),b=e&&e[l-1],P=0,A=0;for(let o=0;o<l;o++)g=(0,r.n6)(t,o,i,s,g),v=Math.sign(8&c?g[1]-a[3]:g[0]-a[2]),m=e&&e[s/i+o],v&&_&&_!==v&&(n(y,g,c,a,f),(0,r.VF)(u,f)&&h.push(b),(0,r.VF)(d,f)&&p.push(b)),v<=0?((0,r.VF)(u,g)&&h.push(m),P-=v):h.length&&(h[h.length-1]=0),v>=0?((0,r.VF)(d,g)&&p.push(m),A+=v):p.length&&(p[p.length-1]=0),(0,r.JG)(y,g),_=v,b=m;return[P?{pos:u,types:e&&h}:null,A?{pos:d,types:e&&p}:null]}function u(t,e,i,n){const s=Math.floor((t[0]-i[0])/e)*e+i[0],r=Math.floor((t[1]-i[1])/e)*e+i[1];return n[0]=s,n[1]=r,n[2]=s+e,n[3]=r+e,n}function d(t,e,i){8&i?(t[1]+=e,t[3]+=e):4&i?(t[1]-=e,t[3]-=e):2&i?(t[0]+=e,t[2]+=e):1&i&&(t[0]-=e,t[2]-=e)}function h(t,e,i,n){let s=1/0,r=-1/0,o=1/0,a=-1/0;for(let n=0;n<i;n+=e){const e=t[n],i=t[n+1];s=e<s?e:s,r=e>r?e:r,o=i<o?i:o,a=i>a?i:a}return n[0][0]=s,n[0][1]=o,n[1][0]=r,n[1][1]=a,n}},26:(t,e,i)=>{i.d(e,{G:()=>a,c:()=>o});var n=i(95540),s=i(82276);const r=85.051129;function o(t,e){const{size:i=2,startIndex:s=0,endIndex:r=t.length,normalize:o=!0}=e||{},a=t.slice(s,r);u(a,i,0,r-s);const c=(0,n.d)(a,{size:i,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const t of c)d(t,i);return c}function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0;const{size:s=2,normalize:r=!0,edgeTypes:o=!1}=i||{};e=e||[];const a=[],h=[];let p=0,f=0;for(let n=0;n<=e.length;n++){const r=e[n]||t.length,o=f,d=c(t,s,p,r);for(let e=d;e<r;e++)a[f++]=t[e];for(let e=p;e<d;e++)a[f++]=t[e];u(a,s,o,f),l(a,s,o,f,null==i?void 0:i.maxLatitude),p=r,h[n]=f}h.pop();const g=(0,n.W)(a,h,{size:s,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(r)for(const t of g)d(t.positions,s);return g}function c(t,e,i,n){let s=-1,r=-1;for(let o=i+1;o<n;o+=e){const e=Math.abs(t[o]);e>s&&(s=e,r=o-1)}return r}function l(t,e,i,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r;const a=t[i],c=t[n-e];if(Math.abs(a-c)>180){const n=(0,s.n6)(t,0,e,i);n[0]+=360*Math.round((c-a)/360),(0,s.VF)(t,n),n[1]=Math.sign(n[1])*o,(0,s.VF)(t,n),n[0]=a,(0,s.VF)(t,n)}}function u(t,e,i,n){let s,r=t[0];for(let o=i;o<n;o+=e){s=t[o];const e=s-r;(e>180||e<-180)&&(s-=360*Math.round(e/360)),t[o]=r=s}}function d(t,e){let i;const n=t.length/e;for(let s=0;s<n&&(i=t[s*e],(i+180)%360==0);s++);const s=360*-Math.round(i/360);if(0!==s)for(let i=0;i<n;i++)t[i*e]+=s}},82276:(t,e,i)=>{function n(t,e){const i=e.length,n=t.length;if(n>0){let s=!0;for(let r=0;r<i;r++)if(t[n-i+r]!==e[r]){s=!1;break}if(s)return!1}for(let s=0;s<i;s++)t[n+s]=e[s];return!0}function s(t,e){const i=e.length;for(let n=0;n<i;n++)t[n]=e[n]}function r(t,e,i,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const r=n+e*i;for(let e=0;e<i;e++)s[e]=t[r+e];return s}i.d(e,{JG:()=>s,VF:()=>n,n6:()=>r})},5804:(t,e,i)=>{i.d(e,{N:()=>u});var n=i(36151),s=i(43193),r=i(42797),o=i(30291),a=i(86109),c=i(33990);const l=t=>{const{fallback:e,small:i,medium:l,large:u,isPlaysInline:d,hasControls:h,isAutoPlay:p,isMuted:f,isPlaying:g,isLooping:v}=t,[,m]=(0,r.hQ)(),{mediaQuery:y}=m,_=(0,o.a)(y.small),b=(0,o.a)(y.medium),P=(0,o.a)(y.large),A=(0,n.useRef)(null);return s.useEffect((()=>{const t=A.current,e=()=>{null==t||t.play()};return null==t||t.load(),t&&(t.defaultMuted=!!f,t.muted=!!f,t.playsInline=Boolean(d),t.controls=!!h,t.loop=!!v,t.autoplay=!!p,g&&t.addEventListener("canplay",e)),()=>{g&&(null==t||t.removeEventListener("canplay",e)),null==t||t.pause()}}),[_,b,P,h,p,v,f,g,d]),(0,a.oM)(t)?(0,c.BX)("video",{height:"100%",width:"100%",ref:A,children:[!_&&!b&&!P&&(0,c.BX)(c.HY,{children:[e&&e.webM&&(0,c.tZ)("source",{src:e.webM,type:"video/webm"}),e&&e.mp4&&(0,c.tZ)("source",{src:e.mp4,type:"video/mp4"})]}),_&&!b&&!P&&(0,c.BX)(c.HY,{children:[i&&i.webM&&(0,c.tZ)("source",{src:i.webM,type:"video/webm"}),i&&i.mp4&&(0,c.tZ)("source",{src:i.mp4,type:"video/mp4"})]}),b&&!P&&(0,c.BX)(c.HY,{children:[l&&l.webM&&(0,c.tZ)("source",{src:l.webM,type:"video/webm"}),l&&l.mp4&&(0,c.tZ)("source",{src:l.mp4,type:"video/mp4"})]}),P&&(0,c.BX)(c.HY,{children:[u&&u.webM&&(0,c.tZ)("source",{src:u.webM,type:"video/webm"}),u&&u.mp4&&(0,c.tZ)("source",{src:u.mp4,type:"video/mp4"})]}),(0,c.tZ)("track",{kind:"captions",src:""})]}):null},u=t=>{const{hasControls:e}=t,i=e?{isLooping:!1,isMuted:!1,isPlaysInline:!1,isAutoPlay:!0}:{isLooping:!0,isMuted:!0,isPlaysInline:!0,isAutoPlay:!0};return(0,a.oM)(t)?(0,c.tZ)(l,{...t,...i}):null}},81162:(t,e,i)=>{i.d(e,{S:()=>n,x:()=>s});const n=1,s={PICKUP_LOCATION_DROPDOWN:"pickup location dropdown",DESTINATION_LOCATION_DROPDOWN:"destination location dropdown",PICKUP_INPUT:"pickup location input",DESTINATION_INPUT:"destination location input"}},8662:(t,e,i)=>{i.d(e,{U:()=>w});var n=i(36151),s=i(19316),r=i.n(s),o=i(42797),a=i(89897),c=i(64640),l=i(89667),u=i(85057),d=i(56864),h=i(33990);const p=t=>{let{$rtl:e}=t;return e?{left:"15px",marginRight:"8px"}:{right:"15px",marginLeft:"8px"}},f=(0,o.zo)("div",(t=>{let{$theme:e}=t;return{height:"100%",cursor:"pointer",width:"1em",display:"flex",alignItems:"center",justifyContent:"center",...p({$rtl:"rtl"===e.direction})}})),g=(0,o.zo)(d.Z,(t=>{let{$error:e,$theme:i}=t;return{color:e?i.colors.negative400:i.colors.black}})),v=t=>{const{fetchCurrentLocation:e,error:i,isVisible:n,locationLabel:s}=t;return n?(0,h.tZ)(f,{children:(0,h.tZ)(g,{title:"",onClick:e,onKeyPress:t=>{t&&"Enter"===t.key&&e()},tabIndex:"0",role:"button","aria-label":s,$error:i,className:"pe-location-fetch"})}):null};var m=i(24549);const y=(0,o.w1)(a.Bc,(()=>({fontSize:"24px"}))),_=t=>t?{right:"22px"}:{left:"22px"},b=(t,e)=>t?{paddingRight:e}:{paddingLeft:e},P=r()(m.mO,300),A=t=>{let{props:e,state:i}=t;const{showLocationButton:s=!1,isLoading:r,locationLabel:o}=e,{isDetectionError:a}=i;return t=>{let{children:c,...l}=t;const u=n.Children.toArray(c).length,d=s&&!u&&!r;return(0,h.BX)(y,{...l,children:[c,(0,h.tZ)(v,{isVisible:d,fetchCurrentLocation:()=>(0,m.mX)({props:e,state:i}),locationLabel:o,error:a})]})}},w=t=>{const[,e]=(0,o.hQ)(),{placeholder:i,startEnhancer:s,rtl:r,locationDetails:a,isLoading:d,suggestions:p,ariaLabel:f,controlRef:g,onOpen:v,onBlur:y,onFocus:w,popoverOverrides:C,dropdownAriaLabel:j,inputAriaLabel:T}=t,[x,S]=n.useState((0,m.jD)(a)),[M,I]=n.useState((0,m.jD)(a)),[E,O]=n.useState(!1);n.useEffect((()=>{S((0,m.jD)(a)),I((0,m.jD)(a))}),[a]),n.useEffect((()=>{Array.isArray(p)&&p.length>0&&I((0,m.Vy)(p))}),[p]);const Z={value:x,setValue:S,options:M,setOptions:I,isDetectionError:E,setIsDetectionError:O};return(0,h.tZ)(c.Z,{options:M,value:x,onChange:e=>{(0,m.x3)({props:t,state:Z},e.value)},onInputChange:e=>{S([{label:e.target.value,id:e.target.value}]),P({props:t},e.target.value)},onOpen:v,onFocus:w,onBlur:y,placeholder:i,type:l.wD.search,isLoading:d,"aria-label":f,controlRef:g,filterOptions:t=>t,overrides:{IconsContainer:{component:A({props:t,state:Z})},ClearIcon:{props:{overrides:{Svg:{style:{width:"33px",height:"33px",cursor:"pointer"}}}}},SearchIcon:{props:{overrides:{Svg:{component:s,props:{size:"20"}}}},style:{..._(r),width:"20px"}},ValueContainer:{props:{...u.ki,"aria-label":T},style:{...b(r,e.sizing.scale950)}},DropdownContainer:{props:{...u.ki,"aria-label":j}},...C?{Popover:{props:{overrides:C}}}:{}}})}},24549:(t,e,i)=>{i.d(e,{mX:()=>c,mO:()=>o,jD:()=>l,Vy:()=>s,do:()=>r,x3:()=>u});var n=i(81162);function s(t){return Array.isArray(t)?t.map((t=>({...t,label:"".concat(t.addressLine1).concat(t.addressLine2?", ".concat(t.addressLine2):"")}))):[]}function r(t){let{value:e,type:i,locale:n,suggestions:s,loadPlaceDetails:r}=t;const{id:o,provider:a}=e[0]||{};o&&Array.isArray(s)&&s.find((t=>t.id===o))&&r({type:i,locale:n,id:String(o),provider:a})}const o=(t,e)=>{let{props:i}=t;const{locale:n,type:s}=i,{lat:r,long:o}=(t=>{let{props:e}=t;const{mapCenter:i,locationDetails:n}=e;return null!=n&&n.lat?{lat:n.lat,long:n.long}:{lat:null==i?void 0:i.latitude,long:null==i?void 0:i.longitude}})({props:i});i.getSuggestions({q:e,type:s,locale:n,lat:r,long:o})},a=(t,e,i)=>{let{state:s}=t;s.setIsDetectionError(e&&i===n.S)},c=t=>{var e;let{props:i,state:n}=t;null===(e=i.onFetchCurrentLocation)||void 0===e||e.call(i),a({state:n},!1),((t,e)=>{var i;null!==(i=window)&&void 0!==i&&null!==(i=i.navigator)&&void 0!==i&&null!==(i=i.geolocation)&&void 0!==i&&i.getCurrentPosition?window.navigator.geolocation.getCurrentPosition((i=>{i&&i.coords&&i.coords.latitude&&i.coords.longitude?t(i.coords):null==e||e({message:"Received invalid position from Geolocation API",code:100})}),e):null==e||e({message:"Geolocation API is not available",code:101})})((t=>{var e;null===(e=i.fetchCurrentLocation)||void 0===e||e.call(i,{lat:t.latitude,lng:t.longitude,lang:i.locale})}),(t=>{a({state:n},!0,t.code)}))},l=t=>{if(null==t||!t.id||!t.fullAddress)return[];const{addressLine1:e="",addressLine2:i=""}=t;return[{...t,label:"".concat(e).concat(i?", ".concat(i):"")}]},u=(t,e)=>{let{props:i,state:n}=t;const{type:s,clearFEPlaceDetails:o}=i;if(!Array.isArray(e)||0===e.length)return n.setValue([]),n.setOptions([]),void o(s);r({value:e,...i})}},46858:(t,e,i)=>{i.d(e,{Z:()=>u});var n=i(42797),s=i(31353),r=i(31578),o=i(33990);const{aspectRatios:a}=r.ZP.values,c=(0,n.zo)("div",(()=>({position:"relative",width:"100%",height:0,paddingBottom:a.aspect_16_9}))),l=(0,n.zo)("iframe",(()=>({position:"absolute",top:0,left:0,width:"100%",height:"100%"})));function u(t){let{videoUrl:e="",autoplay:i,videoTitle:n}=t;const r=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1";const i=s.parse(t,!0);return s.format({...i,query:{...i.query,autoplay:e,controls:"1",modestbranding:"1",rel:"0",showinfo:"0"}})}(e,i);return(0,o.tZ)(c,{children:(0,o.tZ)(l,{allow:"autoplay",className:"player",height:"100%",frameBorder:"0",src:r,title:n||"",width:"100%"})})}},97302:(t,e,i)=>{i.d(e,{Z:()=>r});var n=i(36151),s=i(33990);const r=n.forwardRef((function(t,e){let{title:i="Center",titleId:n,size:r="1em",...o}=t;return(0,s.BX)("svg",{width:r,height:r,viewBox:"0 0 24 24",fill:"none",ref:e,"aria-labelledby":n,...o,children:[void 0===i?(0,s.tZ)("title",{id:n,children:"Center"}):i?(0,s.tZ)("title",{id:n,children:i}):null,(0,s.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.9 10.5H24v3h-3.1c-.7 3.8-3.6 6.8-7.4 7.4V24h-3v-3.1c-3.8-.7-6.8-3.6-7.4-7.4H0v-3h3.1c.7-3.8 3.6-6.8 7.4-7.4V0h3v3.1c3.8.7 6.8 3.6 7.4 7.4ZM6 12c0 3.3 2.7 6 6 6s6-2.7 6-6-2.7-6-6-6-6 2.7-6 6Zm9 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",fill:"currentColor"})]})}))},10415:(t,e,i)=>{i.d(e,{Z:()=>r});var n=i(36151),s=i(33990);const r=n.forwardRef((function(t,e){let{title:i="Circle small",titleId:n,size:r="1em",...o}=t;return(0,s.BX)("svg",{width:r,height:r,viewBox:"0 0 24 24",fill:"none",ref:e,"aria-labelledby":n,...o,children:[void 0===i?(0,s.tZ)("title",{id:n,children:"Circle small"}):i?(0,s.tZ)("title",{id:n,children:i}):null,(0,s.tZ)("path",{d:"M12 17a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z",fill:"currentColor"})]})}))},10307:(t,e,i)=>{i.d(e,{Z:()=>r});var n=i(36151),s=i(33990);const r=n.forwardRef((function(t,e){let{title:i="Square small",titleId:n,size:r="1em",...o}=t;return(0,s.BX)("svg",{width:r,height:r,viewBox:"0 0 24 24",fill:"none",ref:e,"aria-labelledby":n,...o,children:[void 0===i?(0,s.tZ)("title",{id:n,children:"Square small"}):i?(0,s.tZ)("title",{id:n,children:i}):null,(0,s.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17 7H7v10h10V7Z",fill:"currentColor"})]})}))},6591:(t,e,i)=>{i.d(e,{Z:()=>r});var n=i(36151),s=i(33990);const r=n.forwardRef((function(t,e){let{title:i="Youtube",titleId:n,size:r="1em",...o}=t;return(0,s.BX)("svg",{width:r,height:r,viewBox:"0 0 24 24",fill:"none",ref:e,"aria-labelledby":n,...o,children:[void 0===i?(0,s.tZ)("title",{id:n,children:"Youtube"}):i?(0,s.tZ)("title",{id:n,children:i}):null,(0,s.tZ)("path",{d:"M23 12s0-3.85-.46-5.58c-.25-.95-1-1.7-1.94-1.96C18.88 4 12 4 12 4s-6.88 0-8.6.46c-.95.25-1.69 1.01-1.94 1.96C1 8.15 1 12 1 12s.04 3.85.5 5.58c.25.95 1 1.7 1.95 1.96 1.71.46 8.59.46 8.59.46s6.88 0 8.6-.46c.95-.25 1.69-1.01 1.94-1.96.46-1.73.42-5.58.42-5.58Zm-13 3.27V8.73L15.5 12 10 15.27Z",fill:"currentColor"})]})}))},67093:(t,e,i)=>{i.d(e,{Z:()=>o});var n=i(87893),s=i(54669);const r={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class o{static get DRAW_MODE(){return r}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:e=(0,n.hQ)("geometry"),drawMode:i=r.TRIANGLES,attributes:s={},indices:o=null,vertexCount:a=null}=t;this.id=e,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(s,o),this.vertexCount=a||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return"Geometry ".concat(this.id," attribute ").concat(t)}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const e in t){let i=t[e];i=ArrayBuffer.isView(i)?{value:i}:i,(0,s.h)(ArrayBuffer.isView(i.value),"".concat(this._print(e),": must be typed array or object with value as typed array")),"POSITION"!==e&&"positions"!==e||i.size||(i.size=3),"indices"===e?((0,s.h)(!this.indices),this.indices=i):this.attributes[e]=i}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let i=1/0;for(const e in t){const n=t[e],{value:s,size:r,constant:o}=n;!o&&s&&r>=1&&(i=Math.min(i,s.length/r))}return(0,s.h)(Number.isFinite(i)),i}}}}]);